<!DOCTYPE html><html lang=en><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><title>Node.js 如何取得圖片的 Mime Types | Lynk is here</title><meta name=description content="最近工作上有個需求要取得圖片的 mime types，這篇文章簡單紀錄在 Node.js 環境下使用 file-type 套件來取得圖片的 mime types。"><link rel=icon type=image/x-icon href=/images/favicon.ico><meta property=og:type content=website><meta property=og:url content=https://blog.lynkishere.us.kg><meta property=og:title content="Node.js 如何取得圖片的 Mime Types | Lynk is here"><meta property=og:description content="最近工作上有個需求要取得圖片的 mime types，這篇文章簡單紀錄在 Node.js 環境下使用 file-type 套件來取得圖片的 mime types。"><meta property=og:image content=/images/cover/image.jpg><meta name=twitter:card content=summary_large_image><meta name=twitter:title content="Node.js 如何取得圖片的 Mime Types | Lynk is here"><meta name=twitter:description content="最近工作上有個需求要取得圖片的 mime types，這篇文章簡單紀錄在 Node.js 環境下使用 file-type 套件來取得圖片的 mime types。"><meta name=twitter:image content=/images/cover/image.jpg><link rel=stylesheet href=/lib/bootstrap/bootstrap.min.css><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css><link rel=stylesheet href=/lib/prismjs/prism.min.css><link rel=stylesheet href=/lib/prismjs/prism-vsc-dark-plus.css><link rel=stylesheet href=/css/main.css><meta name=generator content="Hexo 7.3.0"></head><body data-bs-theme=dark><script>const theme=window.localStorage.getItem("theme")??"";document.body.dataset.bsTheme=theme</script><div class="min-vh-100 d-flex flex-column"><nav id=navbar class="navbar navbar-expand-lg bg-body-tertiary sticky-top shadow-sm"><div class=container-lg><a id=logo class=navbar-brand href=/ ><img class=me-1 src=/images/logo.png height=50 alt=logo> Lynk is here </a><button class="navbar-toggler px-2" type=button data-bs-toggle=collapse data-bs-target=#navbarSupportedContent><i class="bi bi-list icon-20"></i></button><div class="collapse navbar-collapse" id=navbarSupportedContent><ul class="navbar-nav ms-auto mb-2 mb-lg-0"><li class=nav-item><a class=nav-link href=/ ><i class="bi bi-house-fill icon-20"></i> 首頁</a></li><li class=nav-item><a class=nav-link href=/archives><i class="bi bi-list-ul icon-20"></i> 列表</a></li><li class=nav-item><a class=nav-link href=/categories><i class="bi bi-folder-fill icon-20"></i> 分類</a></li><li class=nav-item><a class=nav-link href=/tags><i class="bi bi-tags-fill icon-20"></i> 標籤</a></li></ul><div class="d-flex justify-content-center"><button id=toggleThemeBtn class="toggleThemeBtn btn" style=border:none><i class="bi bi-lightbulb-fill icon-20"></i></button> <button id=searchBtn class="searchBtn btn" style=border:none data-bs-toggle=modal data-bs-target=#searchModal><i class="bi bi-search icon-20"></i></button></div></div></div></nav><div class="flex-grow-1 container-lg mt-4 mb-5"><div class=post><h1>Node.js 如何取得圖片的 Mime Types</h1><small class=text-body-secondary><time datetime=2023-11-25T01:55:22.000Z>2023-11-25</time></small><hr><div class="d-flex flex-column gap-2 mb-4"><div><div class="d-flex flex-wrap gap-2"><a href=/categories/Backend/ class="btn btn-secondary btn-sm"><i class="bi bi-folder-fill icon-15"></i> Backend</a></div></div><div><div class="tagLinks d-flex flex-wrap gap-2"><a href=/tags/Express/ class="btn btn-secondary btn-sm"><i class="bi bi-tag-fill icon-15"></i> Express </a><a href=/tags/Node-js/ class="btn btn-secondary btn-sm"><i class="bi bi-tag-fill icon-15"></i> Node.js </a><a href=/tags/TypeScript/ class="btn btn-secondary btn-sm"><i class="bi bi-tag-fill icon-15"></i> TypeScript</a></div></div></div><div class="text-center mb-4"><img class="img-fluid rounded" width=1200 height=630 src=/images/cover/image.jpg alt=cover></div><div class=content><p>最近工作上有個需求要取得圖片的 mime types，這篇文章簡單紀錄在 Node.js 環境下使用 file-type 套件來取得圖片的 mime types。</p><blockquote><p>基礎專案可參考 <a href=/tech-blog/Backend/develop-express-with-typescript/ >創建 Express 的 TypeScript 環境</a></p></blockquote><h3 id=安裝套件><a href=#安裝套件 class=headerlink title=安裝套件></a>安裝套件</h3><p>先安裝 <code>file-type</code> 以及會用到的 <code>axios</code></p><pre class=language-none><code class=language-none>pnpm i file-type axios</code></pre><h3 id=功能實做><a href=#功能實做 class=headerlink title=功能實做></a>功能實做</h3><pre class=language-typescript data-language=typescript><code class=language-typescript>import express from &#39;express&#39;;
import axios from &#39;axios&#39;;
import &#123; fileTypeFromBuffer &#125; from &#39;file-type&#39;;

const app &#x3D; express();
const port &#x3D; 3001;

&#x2F;&#x2F; &#x2F;images 路徑去 fetch 隨便一張圖片
app.get(&#39;&#x2F;images&#39;, async (req, res) &#x3D;&gt; &#123;
  const &#123; data &#125; &#x3D; await axios.get(
    &#39;https:&#x2F;&#x2F;resources.finalsite.net&#x2F;images&#x2F;f_auto,q_auto,t_image_size_3&#x2F;v1645721429&#x2F;rdaleorg&#x2F;qblyqgwortzxvb3q4wct&#x2F;testing.jpg&#39;,
    &#123;
      &#x2F;&#x2F; 用 axios fetch 時，記得將 responseType 改為 arraybuffer
      responseType: &#39;arraybuffer&#39;
    &#125;
  );

  const buffer &#x3D; Buffer.from(data);
  &#x2F;&#x2F; fileTypeFromBuffer 方法中傳入圖片的 buffer 就能得到 fileType
  const fileType &#x3D; await fileTypeFromBuffer(buffer); &#x2F;&#x2F; &#123; ext: &#39;jpg&#39;, mime: &#39;image&#x2F;jpeg&#39; &#125;

  &#x2F;&#x2F; fileType.mime 就是我們要的 mime types
  res.contentType(fileType.mime);
  return res.send(Buffer.from(data));
&#125;);

app.listen(port, () &#x3D;&gt; &#123;
  console.log(&#96;Example app: http:&#x2F;&#x2F;localhost:$&#123;port&#125;&#96;);
&#125;);</code></pre></div></div></div><footer class="footer border-top text-center py-3"><div class="container-lg text-body-secondary">© Copyright 2024 By Terry Lin</div></footer></div><div class="modal fade" id=searchModal tabindex=-1><div class=modal-dialog><div class=modal-content><div class=modal-body><div class="position-relative mb-3"><input id=searchInput class=form-control type=search style=padding-left:2.25rem> <span class="position-absolute top-50 translate-middle-y search-icon" style=left:.75rem><i class="bi bi-search"></i></span></div><div id=searchResults class="list-group list-group-flush"></div><div id=searchNoResult class="list-group list-group-flush" style=display:none><span class=list-group-item>查無結果</span></div></div></div></div></div><div class=goTopBtn><button id=goTopBtn class=shadow-sm><i class="bi bi-chevron-up"></i></button></div><script src=/lib/bootstrap/bootstrap.bundle.min.js></script><script src=/lib/prismjs/prism.min.js></script><script src=/lib/fuse/fuse.js></script><script src=/js/utils.js></script><script src=/js/main.js type=module></script></body></html>