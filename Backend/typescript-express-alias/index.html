<!DOCTYPE html><html lang=en><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><title>TypeScript Express 設定路徑別名 (Alias) | Lynk is here</title><meta name=description content="本文章將逐步帶領讀者完成 TypeScript Express 的路徑別名配置，其中包含了開發環境下的配置，與正式環境下的配置。此處提到的路徑別名為 import 時的路徑別名。"><link rel=icon type=image/x-icon href=/tech-blog/images/favicon.ico><meta property=og:type content=website><meta property=og:url content=https://link1515.github.io/tech-blog><meta property=og:title content="TypeScript Express 設定路徑別名 (Alias) | Lynk is here"><meta property=og:description content="本文章將逐步帶領讀者完成 TypeScript Express 的路徑別名配置，其中包含了開發環境下的配置，與正式環境下的配置。此處提到的路徑別名為 import 時的路徑別名。"><meta property=og:image content=/tech-blog/images/cover/ts_x_express.jpg><meta name=twitter:card content=summary_large_image><meta name=twitter:title content="TypeScript Express 設定路徑別名 (Alias) | Lynk is here"><meta name=twitter:description content="本文章將逐步帶領讀者完成 TypeScript Express 的路徑別名配置，其中包含了開發環境下的配置，與正式環境下的配置。此處提到的路徑別名為 import 時的路徑別名。"><meta name=twitter:image content=/tech-blog/images/cover/ts_x_express.jpg><link rel=stylesheet href=/tech-blog/lib/bootstrap/bootstrap.min.css><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css><link rel=stylesheet href=/tech-blog/lib/prismjs/prism.min.css><link rel=stylesheet href=/tech-blog/lib/prismjs/prism-vsc-dark-plus.css><link rel=stylesheet href=/tech-blog/css/main.css><meta name=generator content="Hexo 7.3.0"></head><body data-bs-theme=dark><script>const theme=window.localStorage.getItem("theme")??"";document.body.dataset.bsTheme=theme</script><div class="min-vh-100 d-flex flex-column"><nav id=navbar class="navbar navbar-expand-lg bg-body-tertiary sticky-top shadow-sm"><div class=container-lg><a id=logo class=navbar-brand href=/tech-blog/ ><img class=me-1 src=/tech-blog/images/logo.png height=50 alt=logo> Lynk is here </a><button class="navbar-toggler px-2" type=button data-bs-toggle=collapse data-bs-target=#navbarSupportedContent><i class="bi bi-list icon-20"></i></button><div class="collapse navbar-collapse" id=navbarSupportedContent><ul class="navbar-nav ms-auto mb-2 mb-lg-0"><li class=nav-item><a class=nav-link href=/tech-blog/ ><i class="bi bi-house-fill icon-20"></i> 首頁</a></li><li class=nav-item><a class=nav-link href=/tech-blog/archives><i class="bi bi-list-ul icon-20"></i> 列表</a></li><li class=nav-item><a class=nav-link href=/tech-blog/categories><i class="bi bi-folder-fill icon-20"></i> 分類</a></li><li class=nav-item><a class=nav-link href=/tech-blog/tags><i class="bi bi-tags-fill icon-20"></i> 標籤</a></li></ul><div class="d-flex justify-content-center"><button id=toggleThemeBtn class="toggleThemeBtn btn" style=border:none><i class="bi bi-lightbulb-fill icon-20"></i></button> <button id=searchBtn class="searchBtn btn" style=border:none data-bs-toggle=modal data-bs-target=#searchModal><i class="bi bi-search icon-20"></i></button></div></div></div></nav><div class="flex-grow-1 container-lg mt-4 mb-5"><div class=post><h1>TypeScript Express 設定路徑別名 (Alias)</h1><small class=text-body-secondary><time datetime=2023-11-18T01:41:37.000Z>2023-11-18</time></small><hr><div class="d-flex flex-column gap-2 mb-4"><div><div class="d-flex flex-wrap gap-2"><a href=/tech-blog/categories/Backend/ class="btn btn-secondary btn-sm"><i class="bi bi-folder-fill icon-15"></i> Backend</a></div></div><div><div class="tagLinks d-flex flex-wrap gap-2"><a href=/tech-blog/tags/Express/ class="btn btn-secondary btn-sm"><i class="bi bi-tag-fill icon-15"></i> Express </a><a href=/tech-blog/tags/Node-js/ class="btn btn-secondary btn-sm"><i class="bi bi-tag-fill icon-15"></i> Node.js </a><a href=/tech-blog/tags/TypeScript/ class="btn btn-secondary btn-sm"><i class="bi bi-tag-fill icon-15"></i> TypeScript</a></div></div></div><div class="text-center mb-4"><img class="img-fluid rounded" width=1200 height=630 src=/tech-blog/images/cover/ts_x_express.jpg alt=cover></div><div class=content><p>本文章將逐步帶領讀者完成 TypeScript Express 的路徑別名配置，其中包含了開發環境下的配置，與正式環境下的配置。此處提到的路徑別名為 import 時的路徑別名。</p><blockquote><p>本文章是直接以應用 Express 為主，但做其他開發，也可以採用相同方法。<br>基礎專案可參考 <a href=/tech-blog/Backend/develop-express-with-typescript/ >創建 Express 的 TypeScript 環境</a></p></blockquote><h2 id=使路徑別名在開發環境生效><a href=#使路徑別名在開發環境生效 class=headerlink title=使路徑別名在開發環境生效></a>使路徑別名在開發環境生效</h2><p>開發環境下，我們使用 <code>nodemon</code>，而 <code>nodemon</code> 又使用 <code>ts-node</code>，所以我們的目標便是讓 <code>ts-node</code> 套件可以解析路徑別名</p><h3 id=安裝-tsconfig-paths><a href=#安裝-tsconfig-paths class=headerlink title="安裝 tsconfig-paths"></a>安裝 tsconfig-paths</h3><pre class=language-none><code class=language-none>pnpm i -D tsconfig-paths</code></pre><h3 id=配置-tsconfig-json><a href=#配置-tsconfig-json class=headerlink title="配置 tsconfig.json"></a>配置 tsconfig.json</h3><ul><li>引入 <code>tsconfig-paths/register</code></li><li>配置需要的路徑別名<ul><li>注意: 配置 <code>paths</code> 就一定要配置 <code>baseUrl</code></li><li>我們將 <code>baseUrl</code> 設為 <code>.</code>，即當前專案的根目錄</li><li><code>paths</code> 配置一個映射到 <code>middeware</code> 目錄的路徑別名 <code>@middleware</code></li></ul></li></ul><pre class=language-json data-language=json><code class=language-json>&#123;
    &#x2F;&#x2F; 引入 tsconfig-paths&#x2F;register
    &#x2F;&#x2F; 注意 ts-node 的層級與 compilerOptions 相同
    &quot;ts-node&quot;: &#123;
        &quot;require&quot;: [&quot;tsconfig-paths&#x2F;register&quot;]
    &#125;,
    &quot;compilerOptions&quot;: &#123;
        &#x2F;&#x2F; ...
        &#x2F;&#x2F; 配置需要的 alias
        &quot;baseUrl&quot;: &quot;.&quot;,
        &quot;paths&quot;: &#123;
            &quot;@middleware&#x2F;*&quot;: [&quot;middleware&#x2F;*&quot;],
        &#125;,
        &#x2F;&#x2F; ...
    &#125;
&#125;</code></pre><h3 id=測試><a href=#測試 class=headerlink title=測試></a>測試</h3><p>接著，來創建一個簡單的 <code>middleware</code> 來測試看看路徑別名是否生效</p><pre class=language-typescript data-language=typescript><code class=language-typescript>&#x2F;&#x2F; middleware&#x2F;testMiddleware.ts

import &#123; Request, Response, NextFunction &#125; from &#39;express&#39;;

export const testMiddleware &#x3D; (
  req: Request,
  res: Response,
  next: NextFunction
) &#x3D;&gt; &#123;
  console.log(&#39;alias enabled!&#39;);

  next();
&#125;;</code></pre><p>在入口文件 (<code>index.ts</code>) 中，引入 <code>testMiddleware</code> 並應用到 <code>/</code> 路由下</p><pre class=language-typescript data-language=typescript><code class=language-typescript>&#x2F;&#x2F; index.ts

import express from &#39;express&#39;;
import &#123; testMiddleware &#125; from &#39;@middleware&#x2F;testMiddleware&#39;;

const app &#x3D; express();
const port &#x3D; 3000;

app.get(&#39;&#x2F;&#39;, testMiddleware, (req, res) &#x3D;&gt; &#123;
  res.send(&#39;hello&#39;);
&#125;);

app.listen(port, () &#x3D;&gt; &#123;
  console.log(&#96;Example app url: http:&#x2F;&#x2F;localhost:$&#123;port&#125;&#96;);
&#125;);</code></pre><p>執行 <code>pnpm dev</code> 啟用開發模式，開起 <code>http://localhost:3000</code> 看看終端機有沒有印出 alias enabled!</p><p>至此，我們完成了開發環境下的路徑別名</p><p>但當我們嘗試 <code>pnpm build</code> 正式環境並啟動</p><pre class=language-none><code class=language-none>pnpm build
pnpm start</code></pre><p>會出現 <code>MODULE_NOT_FOUND</code> 的錯誤</p><p>因為在正式環境下，我們是使用 <code>node</code> (而不是 <code>ts-node</code>)，所以剛剛的設定都會無效，<code>node</code> 解析 <code>@middleware/testMiddleware</code> 會認為是在 <code>node_module</code> 中的套件，並報出找不到套件的錯誤，對此，我們還要進行其他設定</p><h2 id=使路徑別名在正式環境生效><a href=#使路徑別名在正式環境生效 class=headerlink title=使路徑別名在正式環境生效></a>使路徑別名在正式環境生效</h2><blockquote><p>此配置也可以用於沒有使用 TypeScript 的專案</p></blockquote><h3 id=安裝-module-alias><a href=#安裝-module-alias class=headerlink title="安裝 module-alias"></a>安裝 module-alias</h3><pre class=language-none><code class=language-none>pnpm i module-alias</code></pre><h3 id=配置-package-json><a href=#配置-package-json class=headerlink title="配置 package.json"></a>配置 package.json</h3><p>此處需要自行配置 <code>build</code> 出來後的資料夾目錄。當前案例，我的 <code>middleware</code> 資料夾 <code>build</code> 完以後會放到 <code>dist/middleware</code></p><pre class=language-json data-language=json><code class=language-json>&quot;_moduleAliases&quot;: &#123;
  &quot;@middleware&quot;: &quot;dist&#x2F;middleware&quot;,
&#125;</code></pre><h3 id=在入口文件-index-ts-中引入-module-alias-register><a href=#在入口文件-index-ts-中引入-module-alias-register class=headerlink title="在入口文件 (index.ts) 中引入 module-alias&#x2F;register"></a>在入口文件 (index.ts) 中引入 module-alias&#x2F;register</h3><p>引入位置需要在所有路徑別名之前，建議放在最上面</p><pre class=language-typescript data-language=typescript><code class=language-typescript>&#x2F;&#x2F; index.ts

import &#39;module-alias&#x2F;register&#39;;
import express from &#39;express&#39;;
import &#123; testMiddleware &#125; from &#39;@middleware&#x2F;testMiddleware&#39;;

const app &#x3D; express();
const port &#x3D; 3000;

app.get(&#39;&#x2F;&#39;, testMiddleware, (req, res) &#x3D;&gt; &#123;
  res.send(&#39;hello&#39;);
&#125;);

app.listen(port, () &#x3D;&gt; &#123;
  console.log(&#96;Example app url: http:&#x2F;&#x2F;localhost:$&#123;port&#125;&#96;);
&#125;);</code></pre><p>再來 <code>build</code> 一次正式環境</p><pre class=language-none><code class=language-none>pnpm build
pnpm start</code></pre><p>就會看到這次可以正常啟動！</p></div></div></div><footer class="footer border-top text-center py-3"><div class="container-lg text-body-secondary">© Copyright 2024 By Terry Lin</div></footer></div><div class="modal fade" id=searchModal tabindex=-1><div class=modal-dialog><div class=modal-content><div class=modal-body><div class="position-relative mb-3"><input id=searchInput class=form-control type=search style=padding-left:2.25rem> <span class="position-absolute top-50 translate-middle-y search-icon" style=left:.75rem><i class="bi bi-search"></i></span></div><div id=searchResults class="list-group list-group-flush"></div><div id=searchNoResult class="list-group list-group-flush" style=display:none><span class=list-group-item>查無結果</span></div></div></div></div></div><div class=goTopBtn><button id=goTopBtn class=shadow-sm><i class="bi bi-chevron-up"></i></button></div><script src=/tech-blog/lib/bootstrap/bootstrap.bundle.min.js></script><script src=/tech-blog/lib/prismjs/prism.min.js></script><script src=/tech-blog/lib/fuse/fuse.js></script><script src=/tech-blog/js/utils.js></script><script src=/tech-blog/js/main.js type=module></script></body></html>