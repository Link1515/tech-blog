<!DOCTYPE html><html lang=en><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><title>用 Google Sheets 產生 JSON 格式 API | Lynk is here</title><meta name=description content="在日常生活和工作中，我們經常使用 Google Sheets 進行資料整理和管理。但是，有沒有想過如何將這些資料變成可以方便地被其他程式或應用程序使用的API呢？ 本文將帶你了解如何利用 Google Sheets，輕鬆又快速地生成一個 API，使得你可以用 JSON 格式獲取你的資料。這樣的做法不僅簡化了資料分享的流程，還為開發者提供了更多應用的可能性。"><link rel=icon type=image/x-icon href=/images/favicon.ico><meta property=og:type content=website><meta property=og:url content=https://blog.lynkishere.us.kg><meta property=og:title content="用 Google Sheets 產生 JSON 格式 API | Lynk is here"><meta property=og:description content="在日常生活和工作中，我們經常使用 Google Sheets 進行資料整理和管理。但是，有沒有想過如何將這些資料變成可以方便地被其他程式或應用程序使用的API呢？ 本文將帶你了解如何利用 Google Sheets，輕鬆又快速地生成一個 API，使得你可以用 JSON 格式獲取你的資料。這樣的做法不僅簡化了資料分享的流程，還為開發者提供了更多應用的可能性。"><meta property=og:image content=/images/cover/google-sheets-to-json.jpg><meta name=twitter:card content=summary_large_image><meta name=twitter:title content="用 Google Sheets 產生 JSON 格式 API | Lynk is here"><meta name=twitter:description content="在日常生活和工作中，我們經常使用 Google Sheets 進行資料整理和管理。但是，有沒有想過如何將這些資料變成可以方便地被其他程式或應用程序使用的API呢？ 本文將帶你了解如何利用 Google Sheets，輕鬆又快速地生成一個 API，使得你可以用 JSON 格式獲取你的資料。這樣的做法不僅簡化了資料分享的流程，還為開發者提供了更多應用的可能性。"><meta name=twitter:image content=/images/cover/google-sheets-to-json.jpg><link rel=stylesheet href=/lib/bootstrap/bootstrap.min.css><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css><link rel=stylesheet href=/lib/prismjs/prism.min.css><link rel=stylesheet href=/lib/prismjs/prism-vsc-dark-plus.css><link rel=stylesheet href=/css/main.css><meta name=generator content="Hexo 7.3.0"></head><body data-bs-theme=dark><script>const theme=window.localStorage.getItem("theme")??"";document.body.dataset.bsTheme=theme</script><div class="min-vh-100 d-flex flex-column"><nav id=navbar class="navbar navbar-expand-lg bg-body-tertiary sticky-top shadow-sm"><div class=container-lg><a id=logo class=navbar-brand href=/ ><img class=me-1 src=/images/logo.png height=50 alt=logo> Lynk is here </a><button class="navbar-toggler px-2" type=button data-bs-toggle=collapse data-bs-target=#navbarSupportedContent><i class="bi bi-list icon-20"></i></button><div class="collapse navbar-collapse" id=navbarSupportedContent><ul class="navbar-nav ms-auto mb-2 mb-lg-0"><li class=nav-item><a class=nav-link href=/ ><i class="bi bi-house-fill icon-20"></i> 首頁</a></li><li class=nav-item><a class=nav-link href=/archives><i class="bi bi-list-ul icon-20"></i> 列表</a></li><li class=nav-item><a class=nav-link href=/categories><i class="bi bi-folder-fill icon-20"></i> 分類</a></li><li class=nav-item><a class=nav-link href=/tags><i class="bi bi-tags-fill icon-20"></i> 標籤</a></li></ul><div class="d-flex justify-content-center"><button id=toggleThemeBtn class="toggleThemeBtn btn" style=border:none><i class="bi bi-lightbulb-fill icon-20"></i></button> <button id=searchBtn class="searchBtn btn" style=border:none data-bs-toggle=modal data-bs-target=#searchModal><i class="bi bi-search icon-20"></i></button></div></div></div></nav><div class="flex-grow-1 container-lg mt-4 mb-5"><div class=post><h1>用 Google Sheets 產生 JSON 格式 API</h1><small class=text-body-secondary><time datetime=2024-01-14T02:52:20.000Z>2024-01-14</time></small><hr><div class="d-flex flex-column gap-2 mb-4"><div><div class="d-flex flex-wrap gap-2"><a href=/categories/Others/ class="btn btn-secondary btn-sm"><i class="bi bi-folder-fill icon-15"></i> Others</a></div></div><div><div class="tagLinks d-flex flex-wrap gap-2"><a href=/tags/API/ class="btn btn-secondary btn-sm"><i class="bi bi-tag-fill icon-15"></i> API </a><a href=/tags/Apps-Script/ class="btn btn-secondary btn-sm"><i class="bi bi-tag-fill icon-15"></i> Apps Script </a><a href=/tags/Google-Sheets/ class="btn btn-secondary btn-sm"><i class="bi bi-tag-fill icon-15"></i> Google Sheets </a><a href=/tags/JSON/ class="btn btn-secondary btn-sm"><i class="bi bi-tag-fill icon-15"></i> JSON</a></div></div></div><div class="text-center mb-4"><img class="img-fluid rounded" width=1200 height=630 src=/images/cover/google-sheets-to-json.jpg alt=cover></div><div class=content><p>在日常生活和工作中，我們經常使用 Google Sheets 進行資料整理和管理。但是，有沒有想過如何將這些資料變成可以方便地被其他程式或應用程序使用的API呢？ 本文將帶你了解如何利用 Google Sheets，輕鬆又快速地生成一個 API，使得你可以用 JSON 格式獲取你的資料。這樣的做法不僅簡化了資料分享的流程，還為開發者提供了更多應用的可能性。</p><h2 id=建立-Google-Sheets><a href=#建立-Google-Sheets class=headerlink title="建立 Google Sheets"></a>建立 Google Sheets</h2><p>先到 <a target=_blank rel=noopener href=https://workspace.google.com/intl/zh-TW/products/sheets/ >Google Sheets</a> 的首頁，進行登入，並新建一個空白的試算表</p><p><img src=/images/posts/google-sheets-to-json/create-sheet.png alt=create-sheet></p><p>範例中我們將試算表的名稱取為 “sheets to json”</p><p><img src=/images/posts/google-sheets-to-json/name-sheet.png alt=name-sheet></p><h2 id=Google-Sheets-中填寫資料><a href=#Google-Sheets-中填寫資料 class=headerlink title="Google Sheets 中填寫資料"></a>Google Sheets 中填寫資料</h2><p>再來我們放上一些資料到 Google Sheets 中，這裡我們放圖片網址 <code>imageUrl</code>、標題 <code>title</code> 與描述 <code>description</code></p><p><img src=/images/posts/google-sheets-to-json/fill-sheet.png alt=fill-sheet></p><h2 id=連接-Apps-Script><a href=#連接-Apps-Script class=headerlink title="連接 Apps Script"></a>連接 Apps Script</h2><p>接著，點上方的 <code>擴充工具 &gt; Apps Script</code>，它會幫我們開啟一個 Google 專用的腳本，裡面可以用 JavaScript 語法來撰寫我們想要的邏輯</p><p><img src=/images/posts/google-sheets-to-json/connect-apps-script.png alt=connect-apps-script></p><p>我們可以在 Apps Script 的資訊中看到當前的腳本已經與試算表做了連接</p><p><img src=/images/posts/google-sheets-to-json/check-connect-state.png alt=check-connect-state></p><h2 id=撰寫-Apps-Script-腳本><a href=#撰寫-Apps-Script-腳本 class=headerlink title="撰寫 Apps Script 腳本"></a>撰寫 Apps Script 腳本</h2><p>點選左邊的編輯器選項，開始撰寫腳本</p><p><img src=/images/posts/google-sheets-to-json/apps-script-editor.png alt=apps-script-editor></p><p>腳本內容</p><pre class=language-javascript data-language=javascript><code class=language-javascript>&#x2F;**
 * 使腳本能接收 GET 請求
 *&#x2F;
function doGet() &#123;
    &#x2F;&#x2F; 設定輸出資料與設定返回格式為 JSON
  return ContentService.createTextOutput(getDataAsJson()).setMimeType(ContentService.MimeType.JSON);
&#125;


&#x2F;**
 * 取得資料並轉為 JSON 格式
 *&#x2F;
function getDataAsJson() &#123;
  &#x2F;&#x2F; 選擇你的表格，getSheetByName(&#39;Sheet1&#39;) 中的 Sheet1 代表試算表下方標籤的名字，我們指定當前用的 Sheet1
  var sheet &#x3D; SpreadsheetApp.getActiveSpreadsheet().getSheetByName(&#39;Sheet1&#39;);

  &#x2F;&#x2F; 取得試算表中所有資料
  var data &#x3D; sheet.getDataRange().getValues();

  &#x2F;&#x2F; 建立一個陣列
  var jsonData &#x3D; [];

  &#x2F;&#x2F; 透過 for 迴圈在 jsonData 中填入資料
  for (var i &#x3D; 1; i &lt; data.length; i++) &#123;
    &#x2F;&#x2F; 建立行物件
    var row &#x3D; &#123;&#125;;
    for (var j &#x3D; 0; j &lt; data[0].length; j++) &#123;
      &#x2F;&#x2F; 以行數為 id
      row.id &#x3D; i;
      &#x2F;&#x2F; 依序填入列名與值
      row[data[0][j]] &#x3D; data[i][j];
    &#125;
    &#x2F;&#x2F; push 到 jsonData 中
    jsonData.push(row);
  &#125;

  &#x2F;&#x2F; 以 json 字串形式返回
  return JSON.stringify(jsonData);
&#125;</code></pre><h2 id=佈署-Apps-Script><a href=#佈署-Apps-Script class=headerlink title="佈署 Apps Script"></a>佈署 Apps Script</h2><p>點擊右上方的佈署，建立新的佈署</p><p><img src=/images/posts/google-sheets-to-json/deploy-apps-script.png alt=deploy-apps-script></p><p>將類別中的 <code>Web app</code> 開啟</p><p><img src=/images/posts/google-sheets-to-json/deploy-web-app-option.png alt=deploy-web-app-option></p><p>給這次的佈署一個簡單的描述，範例中寫 “my web app”，設定執行者 <code>Execute as</code> 為自己 <code>Me (你的 google 帳戶)</code>，設定可使用者 <code>Who has access</code> 為任何人 <code>Anyone</code>，完成後點下方的佈署 <code>Deploy</code></p><blockquote><p>注意，此佈署設定的 API 任何人都可以調用，請留意資料安全問題</p></blockquote><p><img src=/images/posts/google-sheets-to-json/delploy-configuration.png alt=delploy-configuration></p><p>隨後會產生一段網址，這段網址就可以拿來使用囉</p><p><img src=/images/posts/google-sheets-to-json/delploy-success.png alt=delploy-success></p><p>實際產生的 JSON</p><p><img src=/images/posts/google-sheets-to-json/json-response.png alt=json-response></p></div></div></div><footer class="footer border-top text-center py-3"><div class="container-lg text-body-secondary">© Copyright 2024 By Terry Lin</div></footer></div><div class="modal fade" id=searchModal tabindex=-1><div class=modal-dialog><div class=modal-content><div class=modal-body><div class="position-relative mb-3"><input id=searchInput class=form-control type=search style=padding-left:2.25rem> <span class="position-absolute top-50 translate-middle-y search-icon" style=left:.75rem><i class="bi bi-search"></i></span></div><div id=searchResults class="list-group list-group-flush"></div><div id=searchNoResult class="list-group list-group-flush" style=display:none><span class=list-group-item>查無結果</span></div></div></div></div></div><div class=goTopBtn><button id=goTopBtn class=shadow-sm><i class="bi bi-chevron-up"></i></button></div><script src=/lib/bootstrap/bootstrap.bundle.min.js></script><script src=/lib/prismjs/prism.min.js></script><script src=/lib/fuse/fuse.js></script><script src=/js/utils.js></script><script src=/js/main.js type=module></script></body></html>